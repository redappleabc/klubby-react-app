
version: 0.2

env:
  variables:
    ENVIRONMENT: 'dev'

#TODO this needs to know env so it can add to save location, rn conflict with prod

phases:
  pre_build:
    commands:
      # - ANDROID_VERSION=25
      # - ANDROID_TOOLS_VERSION=25.0.2
      # - android-accept-licenses.sh "sudo android update sdk --no-ui --all --filter \"android-$ANDROID_VERSION,tools,platform-tools,build-tools-$ANDROID_TOOLS_VERSION,extra-android-m2repository\""
      # - ls /usr/local/android-sdk-linux
      # - ls /usr/local/android-sdk-linux/tools
      # - ls /usr/local/android-sdk-linux/tools/build-tools
      # - ls /usr/local/android-sdk-linux/tools/build-tools/bin
      # - ls /usr/local/android-sdk-linux/tools/bin
      # - echo "y" | $ANDROID_HOME/tools/bin/sdkmanager "extras;m2repository;com;android;support;constraint;constraint-layout;1.0.2"
  build:
    commands:
      - wget https://services.gradle.org/distributions/gradle-7.4.2-bin.zip -P /tmp
      - unzip -d /opt/gradle /tmp/gradle-7.4.2-bin.zip
      # - /opt/gradle/gradle-7.4.2/bin/gradle build
      - ls
      - ls build
      # Copy to S3
      # - aws s3 cp --recursive android s3://klubby-deployment-ios-dev-pipelineartifactsbucket-1gw13zwjh93vj/android/$ENVIRONMENT